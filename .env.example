# NetNynja Enterprise - Environment Configuration
# Copy this file to .env and update values for your environment

# ===========================================
# Database Configuration
# ===========================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=netnynja
POSTGRES_USER=netnynja
POSTGRES_PASSWORD=changeme_in_production

# Connection string (computed from above or set directly)
POSTGRES_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# ===========================================
# Redis Configuration
# ===========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}

# ===========================================
# NATS Configuration
# ===========================================
NATS_HOST=localhost
NATS_PORT=4222
NATS_URL=nats://${NATS_HOST}:${NATS_PORT}

# NATS Authentication (required for production)
# Set a strong password for production deployments
# NATS_USER=netnynja
# NATS_PASSWORD=changeme_in_production

# NATS TLS (production)
# Generate certificates: ./infrastructure/scripts/generate-nats-certs.sh
# NATS_TLS_ENABLED=true

# ===========================================
# HashiCorp Vault Configuration
# ===========================================
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=dev-only-token

# ===========================================
# JWT Configuration
# ===========================================
# Option 1: HS256 symmetric signing (development only)
# JWT_SECRET=dev-jwt-secret-change-in-production

# Option 2: RS256 asymmetric signing (recommended for production)
# Generate keys with: ./infrastructure/scripts/generate-jwt-keys.sh
# Store keys in Vault for production, or set directly:
# JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
# JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"

# Note: Use either JWT_SECRET (HS256) OR JWT_PRIVATE_KEY/JWT_PUBLIC_KEY (RS256)
# RS256 is strongly recommended for production deployments

JWT_SECRET=dev-jwt-secret-change-in-production
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# ===========================================
# Application Configuration
# ===========================================
NODE_ENV=development
LOG_LEVEL=debug

# Proxy trust settings (for X-Forwarded-For header)
# Set to 'true' when behind a reverse proxy (nginx, load balancer)
# Set to 'false' when directly exposed to the internet (prevents IP spoofing)
# Default: true in development, false in production
# TRUST_PROXY=true

# ===========================================
# Service Port Allocation
# ===========================================
# Web UI (Vite)    : 3000
# API Gateway      : 3001
# Grafana          : 3002
# IPAM Service     : 3003
# NPM Service      : 3004
# STIG Service     : 3005
# Auth Service     : 3006
# ===========================================
WEB_PORT=3000
API_PORT=3001
AUTH_SERVICE_PORT=3006
AUTH_SERVICE_URL=http://localhost:3006

# ===========================================
# CORS Configuration
# ===========================================
# Allowed origins: 'true' (all), 'false' (none), or comma-separated URLs
# Examples: 'true', 'http://localhost:5173', 'https://app.example.com,https://admin.example.com'
CORS_ORIGIN=true
# Allow credentials (cookies, authorization headers)
CORS_CREDENTIALS=true
# Preflight cache duration in seconds (default: 86400 = 24 hours)
CORS_MAX_AGE=86400
# Headers exposed to the client (comma-separated)
CORS_EXPOSED_HEADERS=X-Request-Id,X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset

# ===========================================
# Rate Limiting Configuration
# ===========================================
# Default requests per minute (per user/IP)
RATE_LIMIT_MAX=100
# Auth endpoint requests per minute (stricter - prevents brute force)
RATE_LIMIT_AUTH_MAX=10
# Time window in milliseconds (default: 60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000
# Note: Admin users get 3x limit, Operators get 2x limit

# ===========================================
# Observability Configuration
# ===========================================
GRAFANA_PORT=3002
PROMETHEUS_PORT=9090
LOKI_PORT=3100
JAEGER_PORT=16686
VICTORIA_METRICS_PORT=8428

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=netnynja-enterprise

# ===========================================
# Module-Specific Configuration
# ===========================================

# IPAM
IPAM_SCAN_TIMEOUT=30
IPAM_MAX_CONCURRENT_SCANS=10

# NPM
NPM_SNMP_COMMUNITY=public
NPM_POLL_INTERVAL=60

# STIG
STIG_SSH_TIMEOUT=30
STIG_MAX_CONCURRENT_AUDITS=5

# SSH Security (STIG Auditor)
# Enforce SSH host key verification (default: true)
# Set to false ONLY in isolated lab environments â€” creates MITM risk
STIG_SSH_STRICT_HOST_KEY=true
# Path to known_hosts file (uses system default if not set)
# STIG_SSH_KNOWN_HOSTS_FILE=/app/config/known_hosts
