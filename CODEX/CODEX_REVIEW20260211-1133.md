# CODEX Review 2026-02-11 11:33

**Scope**

- Read-only review and runtime validation of NetNynja Enterprise.
- Includes architecture/threat model, component-by-component review, and live service checks.
- No code or configuration changes performed.

**Sources And Evidence**

- `GO.md`, `CONTEXT.md`, `PROJECT_STATUS.md`, `IssuesTracker.md`, `README.md`, `COMMIT.md`
- `docker-compose.yml`
- Gateway routes: `apps/gateway/src/index.ts`, `apps/gateway/src/routes/ipam/index.ts`, `apps/gateway/src/routes/npm/index.ts`, `apps/gateway/src/routes/syslog/index.ts`, `apps/gateway/src/routes/stig/index.ts`, `apps/gateway/src/routes/stig/ssh-credentials.ts`
- IPAM: `apps/ipam/src/ipam/main.py`, `apps/ipam/src/ipam/api/routes.py`, `apps/ipam/src/ipam/services/scanner.py`, `apps/ipam/src/ipam/core/auth.py`, `apps/ipam/Dockerfile`
- NPM: `apps/npm/src/npm/main.py`, `apps/npm/src/npm/api/routes.py`, `apps/npm/src/npm/collectors/discovery.py`, `apps/npm/src/npm/collectors/snmpv3_poller.py`, `apps/npm/Dockerfile`
- Syslog: `apps/syslog/src/syslog/main.py`, `apps/syslog/src/syslog/collector.py`, `apps/syslog/src/syslog/parser.py`, `apps/syslog/Dockerfile`
- STIG: `apps/stig/src/stig/main.py`, `apps/stig/src/stig/api/routes.py`, `apps/stig/src/stig/core/auth.py`, `apps/stig/src/stig/services/vault.py`, `apps/stig/src/stig/collectors/ssh_auditor.py`, `apps/stig/src/stig/services/config_checker.py`, `apps/stig/src/stig/collectors/config_analyzer.py`
- STIG library and parsing: `apps/stig/src/stig/library/indexer.py`, `apps/stig/src/stig/library/parser.py`
- Runtime checks via `docker compose ps`, `docker compose logs`, and HTTP health endpoints.

---

## Phase 1: Orientation

**What This System Is**

- A unified network management platform combining IPAM, NPM, STIG compliance, and Syslog into a single API gateway and UI, with Python microservices for scanning, collection, auditing, and reporting.

**How It Is Supposed To Run**

- Development and integration are driven by Docker Compose profiles for `ipam`, `npm`, `stig`, and `syslog`, with shared infrastructure services. The UI and gateway run in Node.js containers, and each Python service exposes a FastAPI API with separate collectors/workers.

**Tech Stack**

- API Gateway: Node.js 20+, Fastify 5.x, TypeScript
- Frontend: React 18, Vite 7.x, Tailwind CSS
- Python Services: Python 3.13+, FastAPI, AsyncIO
- Data Stores: PostgreSQL 15, VictoriaMetrics
- Cache: Redis 7
- Messaging: NATS 2.10 with JetStream
- Observability: Prometheus, Loki, Grafana, Jaeger
- Secrets: HashiCorp Vault (dev mode in compose)

**Services And Ports (From `docker-compose.yml`)**

- Web UI: `3000`
- API Gateway: `3001`
- Auth Service: `3006`
- IPAM Service: `3003`
- NPM Service: `3004`
- STIG Service: `3005`
- Syslog API Service: `3007`
- Syslog Collector: `514/udp`, `514/tcp`
- PostgreSQL: `127.0.0.1:5433 -> 5432`
- Redis: `127.0.0.1:6379 -> 6379`
- NATS: `127.0.0.1:4222 -> 4222`, `127.0.0.1:8322 -> 8322`
- Vault: `8300 -> 8200`
- VictoriaMetrics: `127.0.0.1:8428 -> 8428`
- Prometheus: `127.0.0.1:9090 -> 9090`
- Loki: `127.0.0.1:3100 -> 3100`
- Grafana: `127.0.0.1:${GRAFANA_PORT:-3002} -> 3000`
- Jaeger: `127.0.0.1:16686`, `127.0.0.1:4317`, `127.0.0.1:4318`
- Nginx (prod profile): `80`, `443`

**Data Stores, Queues, And State**

- PostgreSQL is the system of record for assets, metrics metadata, STIG definitions, and syslog events.
- VictoriaMetrics stores time-series metrics.
- Redis is used for cache and sessions.
- NATS JetStream is used for eventing and collectors.
- STIG Library content is loaded from a read-only mounted folder (`STIG_LIBRARY_PATH`).

**Auth And Secrets Management**

- JWT-based auth with role-based access control (admin, operator, viewer) in Python services (`apps/ipam/src/ipam/core/auth.py`, `apps/stig/src/stig/core/auth.py`).
- Secrets are expected via environment variables and Vault in production (`apps/stig/src/stig/services/vault.py`).
- SSH credentials are stored in PostgreSQL with AES-256-GCM encryption in the gateway (`apps/gateway/src/routes/stig/ssh-credentials.ts`).

**Runtime Assumptions**

- Development uses dev-mode Vault, default JWT secrets, and local networking in Docker Compose.
- Some collectors require elevated capabilities: `NET_RAW`, `NET_ADMIN`, and binding to port 514.
- Host networking is optional for MAC address detection and accurate syslog source IPs.

**Expected Commands**

- `docker compose up -d` and profile-specific variants (see `README.md` and `docker-compose.yml` comments)
- `npm install`, `npm run dev -w apps/gateway`, `npm run dev -w apps/web-ui`
- `npm run lint`, `npm run test`, `npm run typecheck`
- `poetry install`, `poetry run pytest`, `poetry run ruff check .`, `poetry run black .`

---

## Phase 2: Architecture + Threat Model

**Trust Boundaries**

- Browser to Web UI to API Gateway boundary.
- API Gateway to Python services boundary (HTTP).
- Services to Postgres/Redis/VictoriaMetrics boundary.
- Syslog ingest boundary (raw UDP/TCP 514) to internal processing.
- SSH audit boundary (asyncssh to managed targets).
- STIG library ingestion boundary (local ZIP/XML parsing).
- Vault boundary for credentials retrieval.

**High-Risk Data**

- SSH credentials, private keys, passphrases, and sudo credentials.
- SNMPv3 credentials and device secrets.
- Syslog payloads (may include authentication events, hostnames, IPs).
- STIG audit results and device configurations.
- Potential PII in syslog, device metadata, and user accounts.

**Attack Surfaces**

- Public-facing API gateway endpoints and auth workflows.
- File upload and parsing endpoints for STIG config analysis.
- Syslog UDP/TCP ingestion and parser.
- SSH audit connections and command execution.
- STIG library ZIP/XML parsing.
- Docker image and dependency supply chain.

**Top 10 Risks (Most Likely To Burn Us In Prod)**

1. SSH auditor allows host key verification bypass and uses fallback root credentials when Vault is unavailable (`apps/stig/src/stig/collectors/ssh_auditor.py`).
2. Syslog collector is exposed on `514/udp` and `514/tcp` with no auth and no size limits, enabling ingestion DoS or data poisoning (`docker-compose.yml`, `apps/syslog/src/syslog/collector.py`).
3. Default dev secrets in compose (JWT secret, Vault dev token, encryption key) can be deployed accidentally (`docker-compose.yml`).
4. STIG config file analysis reads full uploads into memory with no size limits, enabling memory exhaustion (`apps/stig/src/stig/api/routes.py`).
5. XML parsing for STIG and config uses `xml.etree.ElementTree` without hardening, which is vulnerable to entity expansion or oversized payloads (`apps/stig/src/stig/library/parser.py`, `apps/stig/src/stig/collectors/config_analyzer.py`).
6. SSH credential encryption uses static scrypt salt and lacks rotation or per-record salt, increasing blast radius if key leaks (`apps/gateway/src/routes/stig/ssh-credentials.ts`).
7. Service-to-service traffic in compose uses plain HTTP; no mTLS enforcement is evident in code or compose for production profiles (`docker-compose.yml`, `apps/stig/src/stig/services/vault.py`).
8. Syslog API uses permissive CORS (`*`) and prints to stdout instead of structured logging, risking audit gaps and misconfig in production (`apps/syslog/src/syslog/main.py`).
9. Scanners and collectors run with elevated capabilities and execute network scans; compromise could provide lateral movement risk (IPAM/NPM collectors, `docker-compose.yml`, `apps/ipam/Dockerfile`).
10. Raw syslog payloads and config content are stored and logged without explicit redaction or size bounds, raising data retention and PII/secret exposure risk (`apps/syslog/src/syslog/collector.py`).

---

## Phase 3: Component-By-Component Review + Testing

**IPAM Module**

- Entry points: `apps/ipam/src/ipam/api/routes.py` (`/api/v1/ipam/*`), gateway routes in `apps/gateway/src/routes/ipam/index.ts`, scanner in `apps/ipam/src/ipam/services/scanner.py`.
- Data flow: HTTP -> FastAPI -> Postgres -> NATS -> scanner -> results -> Postgres -> metrics to VictoriaMetrics.
- Dependency hotspots: `nmap`, `ping`, `netaddr`, `asyncio` subprocess usage.
- AuthN/Z: JWT and role-based dependencies (`apps/ipam/src/ipam/core/auth.py`).
- Input validation: Pydantic models plus query constraints; scan execution uses subprocess with structured args (not shell).
- Error handling/logging: structured logs, errors raised with HTTP status codes.
- Minimal test plan: Not run. Suggested: `docker compose --profile ipam up -d`, `poetry run pytest apps/ipam`, `poetry run ruff check apps/ipam`.
- Failure modes: NATS unavailable, nmap missing, scan timeouts, DB connectivity failures, large CIDR scans overwhelming resources.

**NPM Module**

- Entry points: `apps/npm/src/npm/api/routes.py` (`/api/v1/npm/*`), gateway routes in `apps/gateway/src/routes/npm/index.ts`, collectors in `apps/npm/src/npm/collectors/discovery.py` and `apps/npm/src/npm/collectors/snmpv3_poller.py`.
- Data flow: HTTP -> FastAPI -> Postgres/VictoriaMetrics -> NATS -> collectors -> metrics/alerts -> Postgres/VictoriaMetrics.
- Dependency hotspots: `pysnmp`, `cryptography`, subprocess ping, SNMP OID handling.
- AuthN/Z: JWT and role-based dependencies.
- Input validation: Zod and Pydantic models, query bounds; SNMP credentials decrypted with AES-GCM from env key.
- Error handling/logging: structured logs, retry logic for SNMP engine discovery.
- Minimal test plan: Not run. Suggested: `docker compose --profile npm up -d`, `poetry run pytest apps/npm`, `poetry run ruff check apps/npm`.
- Failure modes: SNMP timeouts, credential decryption failures, metrics pipeline backlog, VictoriaMetrics unreachable.

**Syslog Module**

- Entry points: UDP/TCP collector on port 514 (`apps/syslog/src/syslog/collector.py`), API health endpoints in `apps/syslog/src/syslog/main.py`, gateway routes in `apps/gateway/src/routes/syslog/index.ts`.
- Data flow: raw syslog -> parser -> buffered writes -> Postgres -> NATS publish (`syslog.events`, `syslog.alerts.*`).
- Dependency hotspots: regex parsing, asyncpg batch inserts, NATS publish.
- AuthN/Z: No auth for collector; API endpoints are unauthenticated health checks.
- Input validation: UTF-8 decode with replacement, regex-based parsing; no explicit size limits or rate limits.
- Error handling/logging: structlog in collector; main service uses `print` and permissive CORS (`*`).
- Minimal test plan: Not run. Suggested: `docker compose --profile syslog up -d`, send RFC5424 test messages, validate DB inserts and NATS topics.
- Failure modes: high-volume ingestion overflowing buffer, DB outages, NATS publish failures, message parsing degradation with malformed input.

**STIG Management**

- Entry points: `apps/stig/src/stig/api/routes.py` (`/api/v1/stig/*`), gateway routes in `apps/gateway/src/routes/stig/index.ts`.
- Data flow: HTTP -> Postgres -> audit service -> asyncssh to targets -> results -> Postgres -> report generation to `/app/output` -> download endpoints.
- Dependency hotspots: `asyncssh`, `httpx`, report generation, config analyzers.
- AuthN/Z: JWT validation with role checks; library and rescan endpoints require auth.
- Input validation: Pydantic models, query bounds; config file analysis checks extensions and UTF-8, but reads full file into memory without size guard.
- Error handling/logging: structured logs, explicit HTTP errors for missing targets and definitions.
- Minimal test plan: Not run. Suggested: `docker compose --profile stig up -d`, `poetry run pytest apps/stig`, config analysis tests with small fixture.
- Failure modes: Vault misconfiguration, host key bypass, NATS unavailable, large config files or XML parsing errors.

**SSH Credential DB**

- Entry points: `apps/gateway/src/routes/stig/ssh-credentials.ts`.
- Data flow: HTTP -> Fastify -> PostgreSQL (`stig.ssh_credentials`) with AES-256-GCM encryption using `CREDENTIAL_ENCRYPTION_KEY`.
- Dependencies: Node.js `crypto`, Zod validation, PostgreSQL.
- AuthN/Z: Fastify `requireAuth` for all routes.
- Input validation: Zod schemas, key size limits, sudo configuration validation.
- Error handling/logging: standard Fastify error handling; credential values are not returned in list endpoints.
- Minimal test plan: Not run. Suggested: `npm run test -w apps/gateway`, API contract tests for credential create and test endpoints.
- Failure modes: key rotation not supported, static scrypt salt, accidental dev key usage in production.

**STIG Libraries**

- Entry points: `apps/stig/src/stig/library/indexer.py`, `apps/stig/src/stig/library/parser.py`, library endpoints in `apps/stig/src/stig/api/routes.py`.
- Data flow: read-only STIG ZIPs -> parse XCCDF -> in-memory catalog -> optional JSON cache -> API browse/search.
- Dependencies: `zipfile`, `xml.etree.ElementTree`, JSON cache.
- AuthN/Z: Library endpoints require JWT; rescan requires admin.
- Input validation: limited; ZIP/XML parsing occurs without size or entity restrictions.
- Minimal test plan: Not run. Suggested: `poetry run pytest apps/stig -k library` plus a controlled ZIP fixture.
- Failure modes: zip bombs, oversized XML, parser performance spikes, stale cache files.

**Benchmark And STIG Parsing**

- Entry points: `apps/stig/src/stig/library/parser.py`, `apps/stig/src/stig/collectors/config_analyzer.py`.
- Data flow: STIG ZIP/XML -> parsed rules and metadata -> DB and reporting; config files -> parsed settings -> compliance checks.
- Dependencies: regex and `xml.etree.ElementTree` for XML parsing, custom parsers per platform.
- Input validation: XML parse errors handled; config file decoding requires UTF-8; no size enforcement.
- Error handling/logging: logs parse errors and continues.
- Minimal test plan: Not run. Suggested: XML parsing tests with bounded-size fixtures and adversarial XML.
- Failure modes: malformed XML, entity expansion, high-memory use on large files.

---

## Phase 4: Security And Compliance Assessment

**Secrets Scanning Findings**

- `.env` exists in repo root; treat as sensitive and ensure it is not committed. No secret values were copied into this review.
- Docker Compose contains default dev tokens and JWT secrets that must not be used in production (`docker-compose.yml`).

**Dependency And Supply Chain Risks**

- Python services use `python:3.13-slim-bookworm` base images with system package upgrades (good).
- Several services use `*-alpine` images (Postgres, Redis, NATS, Grafana, Loki, Promtail) that are tracked in IssuesTracker for OpenSSL CVE monitoring.
- XML parsing uses standard library without hardening, risky for untrusted STIG content.

**Container Hardening**

- Production stages for IPAM, NPM, Syslog run as non-root users.
- Collectors require elevated capabilities (`NET_RAW`, `NET_ADMIN`, `NET_BIND_SERVICE`) and should be isolated in production profiles.
- No explicit read-only filesystem or seccomp/apparmor profiles observed in compose.

**Network Exposure**

- Infrastructure services are bound to localhost in compose.
- Syslog collector binds to host ports 514 UDP/TCP.
- Gateway and Web UI are exposed on `0.0.0.0` for development.

**AuthN/Z**

- Role-based access checks exist for IPAM, NPM, and STIG endpoints.
- Syslog collector and health endpoints are unauthenticated.
- STIG SSH auditing uses host key verification disabled and fallback credentials (dev behavior that is dangerous if not gated).

**STIG-Aligned Configuration Concerns**

- Logging is structured in most services, but syslog API uses `print` in `apps/syslog/src/syslog/main.py`.
- Password policy assumptions appear in SSH credential validation but rotation and key management require more controls.
- Lack of mTLS or TLS enforcement between services for production profile is a compliance gap.

**Data Protection At Rest/In Transit**

- SSH credentials stored encrypted in DB with AES-256-GCM; however key derivation uses static salt and there is no rotation.
- Vault integration exists for credential retrieval, but compose uses HTTP Vault dev mode.
- Service-to-service traffic is HTTP in compose; TLS termination appears to be at Nginx for prod profile.

**CI/CD And Release Hygiene**

- Image signing and Trivy/Docker Scout scanning are documented in `PROJECT_STATUS.md` and `IssuesTracker.md`.
- No evidence of SBOM generation or SAST enforcement found in this review; recommend adding if not already present.

---

## Phase 5: Prioritized Action Plan

**Executive Summary (10 Bullets Max)**

- Core architecture is sound and modular, with clear service boundaries and consistent logging and auth patterns.
- Highest risk is SSH audit behavior that disables host key verification and allows fallback root credentials.
- Syslog ingestion is high-exposure and lacks size limits or auth controls.
- Default dev secrets in compose are a critical foot-gun for production deployments.
- STIG parsing relies on non-hardened XML parsing and lacks file size controls.
- SSH credential encryption uses static salt and lacks key rotation.
- Collector containers need stricter isolation controls in production.
- Service-to-service traffic is plain HTTP in compose; production TLS expectations need explicit enforcement.
- Test coverage for parsing and ingestion appears under-specified for adversarial inputs.
- Documentation is strong but should add explicit production security guardrails.

**Top Risks (Ranked)**

- Critical: SSH auditor accepts missing credentials and skips host key verification. Impact: unauthorized access or MITM. Likelihood: medium. Evidence: `apps/stig/src/stig/collectors/ssh_auditor.py`. Fix: remove fallback, enforce host key verification, require Vault credentials or fail.
- High: Syslog ingestion on 514 without auth or size limits. Impact: DoS/data poisoning. Likelihood: high. Evidence: `apps/syslog/src/syslog/collector.py`, `docker-compose.yml`. Fix: add rate limits, size caps, optional mTLS or IP allowlist, and buffer backpressure.
- High: Default dev secrets in compose and configs. Impact: credential compromise in prod. Likelihood: medium. Evidence: `docker-compose.yml`. Fix: remove defaults for prod profiles, validate env at startup.
- High: XML parsing without defusedxml or size limits. Impact: resource exhaustion or parser abuse. Likelihood: medium. Evidence: `apps/stig/src/stig/library/parser.py`, `apps/stig/src/stig/collectors/config_analyzer.py`. Fix: use `defusedxml` and enforce size limits on uploads and ZIP contents.
- Medium: SSH credential encryption uses static salt and no rotation. Impact: key compromise blast radius. Likelihood: medium. Evidence: `apps/gateway/src/routes/stig/ssh-credentials.ts`. Fix: per-record salt, KMS or Vault transit, and rotation strategy.
- Medium: Syslog API service CORS wide open and uses `print`. Impact: audit gaps and accidental exposure. Likelihood: low to medium. Evidence: `apps/syslog/src/syslog/main.py`. Fix: restrict CORS, enforce structured logging.
- Medium: Collectors run with elevated capabilities. Impact: lateral movement if compromised. Likelihood: low to medium. Evidence: `docker-compose.yml`, `apps/ipam/Dockerfile`. Fix: least privilege and network segmentation.
- Medium: Service-to-service traffic over HTTP by default. Impact: internal MITM risk. Likelihood: low to medium. Evidence: `docker-compose.yml`. Fix: mTLS or service mesh in production.

**Launch Blockers**

- Remove SSH auditor fallback credentials and enforce host key verification in production configuration.
- Introduce size limits and parsing hardening for STIG config uploads and XML parsing.
- Ensure production profiles cannot start with dev secrets or Vault dev mode.
- Establish syslog ingestion controls (rate limiting, size caps, IP allowlist or auth).

**Quick Wins (<= 1 Day)**

- Add size caps and MIME/extension validation for config upload endpoints.
- Add syslog message length cap and drop oversize payloads.
- Replace `print` in syslog API with structured logging and tighten CORS.
- Document production env requirements and remove dev defaults from production profile.

**Near-Term (<= 2 Weeks)**

- Remove fallback root credentials and enforce host key verification or explicit allowlist for SSH audits.
- Adopt `defusedxml` for all XML parsing in STIG library and config analyzers.
- Add key rotation plan and per-record salt for SSH credential encryption.
- Implement syslog ingestion rate limiting and source allowlisting.

**Longer-Term (Roadmap)**

- Enforce mTLS for service-to-service traffic or adopt a service mesh.
- Add SBOM generation, SAST, and dependency policy enforcement to CI.
- Add security-focused test suite for parser and file handling edge cases.

**Doc Updates Needed (Describe Only, Do Not Implement)**

- Add explicit production security guardrails in `README.md` and `GO.md` (no dev defaults, TLS expectations, Vault requirements).
- Add threat model and syslog ingestion safety guidance to `CONTEXT.md`.
- Add SSH audit security requirements and host key verification policy to `PROJECT_STATUS.md` or security docs.

---

## Runtime Validation (Live Checks)

**Container Status**

- All services in the `netnynja-enterprise` compose project are running.
- Healthchecks: gateway, auth-service, IPAM, NPM, STIG, syslog API, Postgres, Redis, NATS, Grafana, Prometheus, Loki, Jaeger, VictoriaMetrics, Vault were healthy.

**Collector Logs (Tail)**

- `npm-collector` actively polling; SNMPv3 polling for `192.168.80.2` with `NPM-USER` observed. CPU metrics returned (e.g., 7.0), memory total returned, disk metrics were `None`. This aligns with `NPM-004` (Arista disk metrics missing).
- `stig-collector` shows clean startup, DB pool init, NATS connection, and consumer started.
- `syslog-collector` had no recent log lines in the last 500 lines, suggesting no inbound syslog traffic or minimal logging.

**NATS + VictoriaMetrics Health**

- NATS monitor `/healthz` and `/varz` responded `200`.
- VictoriaMetrics `/health` and `/api/v1/status/tsdb` responded `200`.
- No write tests were performed to avoid mutating state.

**API Smoke Tests (Read-Only, Unauthenticated)**

- Gateway `/healthz` returned `200`.
- Gateway protected endpoints returned `401` as expected without auth:
  - `/api/v1/ipam/networks`
  - `/api/v1/npm/devices`
  - `/api/v1/syslog/events`
- Gateway STIG endpoints:
  - `/api/v1/stig/targets` returned `404` because gateway exposes targets as `/api/v1/stig/assets` (not `/targets`).
  - `/api/v1/stig/library` and `/api/v1/stig/library/summary` returned `404` because gateway only exposes `/library/upload` and `/library/:id` routes, while full library browsing exists on the STIG service directly.
- Direct STIG service routes exist and are auth-protected (`401` without token):
  - `http://localhost:3005/api/v1/stig/targets`
  - `http://localhost:3005/api/v1/stig/library`

**Syslog Event Count (Read-Only DB Query)**

- Multiple read-only `psql` queries executed successfully but output appeared suppressed, returning only `(1 row)` with no visible value. The numeric event count could not be confirmed with current output formatting.
- `psql` is present and responds to `--version` inside the container.

---

## Open Findings From Runtime Checks

1. **Gateway STIG route mismatch**
   - Gateway uses `/api/v1/stig/assets` instead of `/api/v1/stig/targets`, and does not proxy the STIG library browse/summary endpoints.
   - Client requests to `/api/v1/stig/targets` or `/api/v1/stig/library` will 404 on the gateway even though the STIG service supports them.

2. **NPM disk metrics for Arista**
   - Logs show disk metrics returning `None` for Arista; consistent with open issue `NPM-004`.

3. **Syslog ingestion visibility**
   - No syslog collector logs in last 500 lines and event count not retrieved due to `psql` output suppression. Requires alternate validation.

---

## Commands Run (Read-Only)

- `docker compose ps`
- `docker compose logs --tail 200 syslog-collector npm-collector stig-collector`
- `docker compose logs --tail 500 syslog-collector`
- HTTP checks:
  - `http://localhost:3001/healthz`
  - `http://localhost:3006/healthz`
  - `http://localhost:3003/healthz`
  - `http://localhost:3004/healthz`
  - `http://localhost:3005/healthz`
  - `http://localhost:3007/healthz`
  - `http://localhost:3000`
  - `http://localhost:8322/healthz`
  - `http://localhost:8322/varz`
  - `http://localhost:8428/health`
  - `http://localhost:8428/api/v1/status/tsdb`
  - `http://localhost:3001/api/v1/ipam/networks`
  - `http://localhost:3001/api/v1/npm/devices`
  - `http://localhost:3001/api/v1/syslog/events`
  - `http://localhost:3001/api/v1/stig/targets`
  - `http://localhost:3001/api/v1/stig/library`
  - `http://localhost:3001/api/v1/stig/assets`
  - `http://localhost:3001/api/v1/stig/library/upload`
  - `http://localhost:3001/api/v1/stig/library/summary`
  - `http://localhost:3005/api/v1/stig/targets`
  - `http://localhost:3005/api/v1/stig/library`
  - `http://localhost:3004/api/v1/npm/devices`
  - `http://localhost:3003/api/v1/ipam/networks`
  - `http://localhost:3007/healthz`
- DB count attempts (read-only):
  - `docker compose exec -T postgres sh -c 'psql ... SELECT COUNT(*) FROM syslog.events;'` (multiple formatting attempts; output suppressed)

---

## Recommendations Specific To Runtime Findings

- Document gateway STIG route paths (`/assets`, `/library/upload`, `/library/:id`) in the UI/client and align expectations with service paths to avoid 404s.
- Add a read-only syslog admin endpoint (count and last event timestamp) in the syslog API service to avoid reliance on `psql` output quirks.
- Continue investigation of Arista disk metrics; logs confirm CPU/memory are populating but disk remains `None`.
